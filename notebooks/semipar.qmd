---
title: "Agriculture processing"
format:
  html:
    code-fold: true
jupyter: python3
---

```{python}
import os
os.chdir("..")
```

```{python}
from src.data.data_process import DataReg
from pygam.datasets import wage
from pygam import LinearGAM, s, f
import pandas as pd
import numpy as np
import ibis

ibis.options.interactive = True
```

```{python}
d = DataReg()
df = d.semipar_data()
```


```{python}
df.year.min()
```
```{python}
df2 = df[df["log_employment_avg"].notnull() & df["log_in_labor_force"].notnull() & df["empleo_pr"].notnull()]
```

```{python}
df2[["log_in_labor_force"]].values
```

```{python}
gam = LinearGAM(s(0) + s(1) + f(2)).fit(df2[["log_in_labor_force", "empleo_pr"]].values, df2[["log_employment_avg"]].values)
```

```{python}
gam = LinearGAM(s(0)).fit(df2[["log_in_labor_force"]].values, df2[["log_employment_avg"]].values)

```

```{python}
lam = np.logspace(-3, 5, 5)
lams = [lam] * 3

gam.gridsearch(X, y, lam=lams)
gam.summary()
```