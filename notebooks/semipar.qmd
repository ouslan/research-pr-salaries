---
title: "Agriculture processing"
format:
  html:
    code-fold: true
jupyter: python3
---

```{python}
import os
os.chdir("..")
```

```{python}
from src.data.data_process import DataReg
from pygam import PoissonGAM, s, te
import pandas as pd
import numpy as np
import ibis
```

```{python}
d = DataReg()
df = d.semipar_data().to_pandas()
```

```{python}
df
```

```{python}
gam = PoissonGAM(s(0, n_splines=200) + te(3, 1) + s(2)).fit(df[["total_wages", "mean_travel_time_to_work_minutes"]].values, df[["total_employment"]].values)
gam.summary()
```

```{python}
from pygam import PoissonGAM, s, te
from pygam.datasets import chicago

X, y = chicago(return_X_y=True)

gam = PoissonGAM(s(0, n_splines=200) + te(3, 1) + s(2)).fit(X, y)
gam.summary()
X.shape
```