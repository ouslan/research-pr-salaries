---
title: "Agriculture processing"
format:
  html:
    code-fold: true
jupyter: python3
---

```{python}
import os
os.chdir("..")
```

```{python}
import pandas as pd
import ibis
from src.data.data_process import DataReg

ibis.options.interactive = True
d = DataReg()
```

```{python}
df = d.conn.table("qcewtable")
df = df.select(["year", "qtr", "naics_code", "latitude", "longitude", "first_month_employment", "second_month_employment", "third_month_employment", "total_wages"])
df = df.filter(df.latitude != "")
df = df.cast(
            {
                "first_month_employment": "float64",
                "second_month_employment": "float64",
                "third_month_employment": "float64",
                "year": "int32",
                "qtr": "int32",
                "total_wages": "float64",
                "latitude": "float64",
                "longitude": "float64",
            })
df
```